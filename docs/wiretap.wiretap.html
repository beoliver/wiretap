<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>wiretap.wiretap documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name"></span> <span class="project-version"></span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>wiretap</span></div></div></li><li class="depth-2 branch"><a href="wiretap.tools.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tools</span></div></a></li><li class="depth-2 current"><a href="wiretap.wiretap.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>wiretap</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="wiretap.wiretap.html#var-install.21"><div class="inner"><span>install!</span></div></a></li><li class="depth-1"><a href="wiretap.wiretap.html#var-install-post.21"><div class="inner"><span>install-post!</span></div></a></li><li class="depth-1"><a href="wiretap.wiretap.html#var-install-pre.21"><div class="inner"><span>install-pre!</span></div></a></li><li class="depth-1"><a href="wiretap.wiretap.html#var-uninstall.21"><div class="inner"><span>uninstall!</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">wiretap.wiretap</h1><div class="doc"><pre class="plaintext">Main entry point for the wiretap library.
</pre></div><div class="public anchor" id="var-install.21"><h3>install!</h3><div class="usage"><code>(install! f vars)</code></div><div class="doc"><div class="markdown"><p>For every applicable var in vars - removes any existing wiretap and alters the root binding to be a variadic function closing over the value <code>g</code> of the var and the user provided function <code>f</code>.</p>
<blockquote>
<p>A var is considered applicable if its metadata does not contain the key <code>:wiretap.wiretap/exclude</code> and its value implements Fn, i.e. is an object created via <code>fn</code>.</p>
</blockquote>
<p>When the resulting “wiretapped” function is called, a map representing the <strong>context</strong> of the call is first passed to <code>f</code> before the result is computed by applying <code>g</code> to to any args provided. <code>f</code> is then called with an updated context before the result is returned. In both cases, <code>f</code> is executed within a <code>try/catch</code> on the same thread. The result of calling <code>f</code> is discarded.</p>
<p>Returns a coll of all modified vars.</p>
<p>The following contextual data is will <strong>always</strong> be present in the map passed to <code>f</code>:</p>
<table>
<thead>
<tr><th> Key         </th><th> When     </th><th> Value                                                            </th></tr>
</thead>
<tbody>
<tr><td> <code>:id</code>       </td><td> pre/post </td><td> Uniquely identifies the call. Same value for pre and post calls. </td></tr>
<tr><td> <code>:name</code>     </td><td> pre/post </td><td> A symbol. Taken from the <em>meta</em> of the var.                      </td></tr>
<tr><td> <code>:ns</code>       </td><td> pre/post </td><td> A namespace. Taken from the <em>meta</em> of the var.                   </td></tr>
<tr><td> <code>:function</code> </td><td> pre/post </td><td> The value that will be applied to the value of <code>:args</code>.          </td></tr>
<tr><td> <code>:thread</code>   </td><td> pre/post </td><td> The name of the thread.                                          </td></tr>
<tr><td> <code>:stack</code>    </td><td> pre/post </td><td> The current stacktrace.                                          </td></tr>
<tr><td> <code>:depth</code>    </td><td> pre/post </td><td> Number of <em>wiretapped</em> function calls on the stack.              </td></tr>
<tr><td> <code>:args</code>     </td><td> pre/post </td><td> The seq of args that value of <code>:function</code> will be applied to.    </td></tr>
<tr><td> <code>:start</code>    </td><td> pre/post </td><td> Nanoseconds since some fixed but arbitrary origin time.          </td></tr>
<tr><td> <code>:parent</code>   </td><td> pre/post </td><td> The context of the previous wiretapped function on the stack.    </td></tr>
<tr><td> <code>:pre?</code>     </td><td> pre      </td><td> <code>true</code>                                                           </td></tr>
<tr><td> <code>:post?</code>    </td><td> post     </td><td> <code>true</code>                                                           </td></tr>
<tr><td> <code>:stop</code>     </td><td> post     </td><td> Nanoseconds since some fixed but arbitrary origin time.          </td></tr>
<tr><td> <code>:result</code>   </td><td> post     </td><td> The result of applying the value of <code>:function</code> to <code>:args</code>.      </td></tr>
<tr><td> <code>:error</code>    </td><td> post     </td><td> Any exception caught during computation of the result.           </td></tr>
</tbody>
</table>
<p>If the wiretapped var is a multimethod then the following information will also be present.</p>
<table>
<thead>
<tr><th> Key              </th><th> When     </th><th> Value                                                       </th></tr>
</thead>
<tbody>
<tr><td> <code>:multimethod?</code>  </td><td> pre/post </td><td> <code>true</code>                                                      </td></tr>
<tr><td> <code>:dispatch-val</code>  </td><td> pre/post </td><td> The dispatch value used to select the method.               </td></tr>
</tbody>
</table>
</div></div></div><div class="public anchor" id="var-install-post.21"><h3>install-post!</h3><div class="usage"><code>(install-post! f vars)</code></div><div class="doc"><div class="markdown"><p>Like <code>install!</code> but ensures that <code>f</code> is only called <strong>post</strong> invocation.</p>
<p>The following contextual data is will <strong>always</strong> be present in the map passed to <code>f</code>:</p>
<table>
<thead>
<tr><th> Key         </th><th> Value                                                            </th></tr>
</thead>
<tbody>
<tr><td> <code>:id</code>       </td><td> Uniquely identifies the call. Same value for pre and post calls. </td></tr>
<tr><td> <code>:name</code>     </td><td> A symbol. Taken from the <em>meta</em> of the var.                      </td></tr>
<tr><td> <code>:ns</code>       </td><td> A namespace. Taken from the <em>meta</em> of the var.                   </td></tr>
<tr><td> <code>:function</code> </td><td> The value that will be applied to the value of <code>:args</code>.          </td></tr>
<tr><td> <code>:thread</code>   </td><td> The name of the thread.                                          </td></tr>
<tr><td> <code>:stack</code>    </td><td> The current stacktrace.                                          </td></tr>
<tr><td> <code>:depth</code>    </td><td> Number of <em>wiretapped</em> function calls on the stack.              </td></tr>
<tr><td> <code>:args</code>     </td><td> The seq of args that value of <code>:function</code> will be applied to.    </td></tr>
<tr><td> <code>:start</code>    </td><td> Nanoseconds since some fixed but arbitrary origin time.          </td></tr>
<tr><td> <code>:parent</code>   </td><td> The context of the previous wiretapped function on the stack.    </td></tr>
<tr><td> <code>:post?</code>    </td><td> <code>true</code>                                                           </td></tr>
<tr><td> <code>:stop</code>     </td><td> Nanoseconds since some fixed but arbitrary origin time.          </td></tr>
<tr><td> <code>:result</code>   </td><td> The result of applying the value of <code>:function</code> to <code>:args</code>.      </td></tr>
<tr><td> <code>:error</code>    </td><td> Any exception caught during computation of the result.           </td></tr>
</tbody>
</table>
<p>If the wiretapped var is a multimethod then the following information will also be present.</p>
<table>
<thead>
<tr><th> Key              </th><th> Value                                                       </th></tr>
</thead>
<tbody>
<tr><td> <code>:multimethod?</code>  </td><td> <code>true</code>                                                      </td></tr>
<tr><td> <code>:dispatch-val</code>  </td><td> The dispatch value used to select the method.               </td></tr>
</tbody>
</table>
</div></div></div><div class="public anchor" id="var-install-pre.21"><h3>install-pre!</h3><div class="usage"><code>(install-pre! f vars)</code></div><div class="doc"><div class="markdown"><p>Like <code>install!</code> but ensures that <code>f</code> is only called <strong>pre</strong> invocation.</p>
<p>The following contextual data is will <strong>always</strong> be present in the map passed to <code>f</code>:</p>
<table>
<thead>
<tr><th> Key         </th><th> Value                                                            </th></tr>
</thead>
<tbody>
<tr><td> <code>:id</code>       </td><td> Uniquely identifies the call. Same value for pre and post calls. </td></tr>
<tr><td> <code>:name</code>     </td><td> A symbol. Taken from the <em>meta</em> of the var.                      </td></tr>
<tr><td> <code>:ns</code>       </td><td> A namespace. Taken from the <em>meta</em> of the var.                   </td></tr>
<tr><td> <code>:function</code> </td><td> The value that will be applied to the value of <code>:args</code>.          </td></tr>
<tr><td> <code>:thread</code>   </td><td> The name of the thread.                                          </td></tr>
<tr><td> <code>:stack</code>    </td><td> The current stacktrace.                                          </td></tr>
<tr><td> <code>:depth</code>    </td><td> Number of <em>wiretapped</em> function calls on the stack.              </td></tr>
<tr><td> <code>:args</code>     </td><td> The seq of args that value of <code>:function</code> will be applied to.    </td></tr>
<tr><td> <code>:start</code>    </td><td> Nanoseconds since some fixed but arbitrary origin time.          </td></tr>
<tr><td> <code>:parent</code>   </td><td> The context of the previous wiretapped function on the stack.    </td></tr>
<tr><td> <code>:pre?</code>     </td><td> <code>true</code>                                                           </td></tr>
</tbody>
</table>
<p>If the wiretapped var is a multimethod then the following information will also be present.</p>
<table>
<thead>
<tr><th> Key              </th><th> Value                                                       </th></tr>
</thead>
<tbody>
<tr><td> <code>:multimethod?</code>  </td><td> <code>true</code>                                                      </td></tr>
<tr><td> <code>:dispatch-val</code>  </td><td> The dispatch value used to select the method.               </td></tr>
</tbody>
</table>
</div></div></div><div class="public anchor" id="var-uninstall.21"><h3>uninstall!</h3><div class="usage"><code>(uninstall!)</code><code>(uninstall! vars)</code></div><div class="doc"><div class="markdown"><p>Uninstalls all wiretaps from all applicable vars in vars.</p>
<p>A var is considered applicable if the key <code>:wiretap.wiretap/uninstall</code> is present in the metadata and the key <code>:wiretap.wiretap/exclude</code> is not.</p>
<p>Returns a coll of all modified vars.</p>
</div></div></div></div></body></html>